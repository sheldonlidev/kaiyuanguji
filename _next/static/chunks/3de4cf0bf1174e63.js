(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},85130,89271,e=>{"use strict";var t,r=((t={}).WORK="work",t.COLLECTION="collection",t.BOOK="book",t);e.s(["BookResourceType",()=>r],89271);var s=e.i(85149);let a={};async function o(e,t){try{let s=await fetch(e,{cache:"no-store",signal:AbortSignal.timeout(5e3)});if(!s.ok)throw Error(`Failed to fetch from ${e}: ${s.statusText}`);let a=await s.json(),o=[],l=(e,r)=>{e&&Object.values(e).forEach(e=>{o.push({id:e.id,name:e.title||e.name,type:r,isDraft:t,rawPath:e.path,author:e.author,collection:e.collection,year:e.year,holder:e.holder})})};return l(a.books,r.BOOK),l(a.collections,r.COLLECTION),l(a.works,r.WORK),o}catch(e){throw e}}async function l(e="github"){if(a[e])return a[e];let t=[],r=async t=>{if("github"===e)return o(t?s.GITHUB_BOOK_INDEX_DRAFT:s.GITHUB_BOOK_INDEX,t);let r=t?"book-index-draft":"book-index",a="main",l=`${s.JSDELIVR_FASTLY}/${s.GITHUB_ORG}/${r}@${a}/index.json`,i=`${s.JSDELIVR_CDN}/${s.GITHUB_ORG}/${r}@${a}/index.json`;try{return await o(l,t)}catch(e){return console.warn("Fastly index fetch failed, trying fallback:",e),await o(i,t)}};try{let e=await r(!0);t.push(...e)}catch(t){console.warn(`Failed to fetch draft index from ${e}:`,t)}try{let e=await r(!1);t.push(...e)}catch(t){console.warn(`Failed to fetch official index from ${e}:`,t)}let i=new Map;t.forEach(e=>{i.set(e.id,e)});let n=Array.from(i.values());return a[e]=n,n}async function i(e,t="github"){return(await l(t)).find(t=>t.id===e)||null}async function n(e,t="github"){if("github"===t){let r=e.isDraft?`${s.GITHUB_BASE}/${s.GITHUB_ORG}/book-index-draft/main`:`${s.GITHUB_BASE}/${s.GITHUB_ORG}/book-index/main`,a=`${r}/${e.rawPath}`,o=await fetch(a,{cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!o.ok)throw Error(`Failed to fetch book detail from ${t}: ${o.statusText}`);return o.json()}let r=e.isDraft?"book-index-draft":"book-index",a="main",o=`${s.JSDELIVR_FASTLY}/${s.GITHUB_ORG}/${r}@${a}/${e.rawPath}`,l=`${s.JSDELIVR_CDN}/${s.GITHUB_ORG}/${r}@${a}/${e.rawPath}`;try{let e=await fetch(o,{cache:"no-store",signal:AbortSignal.timeout(8e3)});if(!e.ok)throw Error(`Fastly status: ${e.status}`);return await e.json()}catch(t){console.warn("Fastly fetch failed, trying fallback CDN:",t);let e=await fetch(l,{cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!e.ok)throw Error(`Failed to fetch book detail from CDN: ${e.statusText}`);return await e.json()}}function c(e){switch(e){case r.WORK:return"‰ΩúÂìÅ";case r.COLLECTION:return"‰∏õÁºñ";case r.BOOK:return"‰π¶";default:return""}}function d(e){return e?"ËçâÁ®ø":"Ê≠£Âºè"}e.s(["fetchAllBooks",()=>l,"fetchBookDetail",()=>n,"findBookById",()=>i,"getStatusLabel",()=>d,"getTypeLabel",()=>c],85130)},40867,e=>{"use strict";var t=e.i(18050),r=e.i(71645),s=e.i(89271),a=e.i(85130),o=e.i(22016);function l({book:e}){return(0,t.jsx)(o.default,{href:`/book-index/${e.id}`,className:"block p-4 bg-white border border-border rounded-lg hover:border-vermilion hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0 mt-0.5",children:(()=>{switch(e.type){case s.BookResourceType.WORK:return"üìñ";case s.BookResourceType.COLLECTION:return"üìö";case s.BookResourceType.BOOK:return"üìï";default:return"üìÑ"}})()}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-ink mb-2 break-words",children:e.name}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm text-secondary",children:[e.author&&(0,t.jsxs)("span",{className:"text-xs",children:["‰ΩúËÄÖ: ",e.author]}),e.year&&(0,t.jsx)("span",{className:"text-xs",children:e.year})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 items-end flex-shrink-0",children:[(0,t.jsx)("span",{className:`
              px-2 py-1 text-xs font-medium rounded border
              ${(()=>{switch(e.type){case s.BookResourceType.WORK:return"text-blue-600 bg-blue-50 border-blue-200";case s.BookResourceType.COLLECTION:return"text-purple-600 bg-purple-50 border-purple-200";case s.BookResourceType.BOOK:return"text-vermilion bg-vermilion/5 border-vermilion/20";default:return"text-secondary bg-paper border-border"}})()}
            `,children:(0,a.getTypeLabel)(e.type)}),(0,t.jsx)("span",{className:`
              px-2 py-1 text-xs font-medium rounded
              ${e.isDraft?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"}
            `,children:(0,a.getStatusLabel)(e.isDraft)})]})]})})}var i=e.i(67920);let n=[{id:"all",label:"ÂÖ®ÈÉ®"},{id:s.BookResourceType.WORK,label:"‰ΩúÂìÅ"},{id:s.BookResourceType.COLLECTION,label:"‰∏õÁºñ"},{id:s.BookResourceType.BOOK,label:"‰π¶"}];function c({currentPage:e,totalPages:r,onPageChange:s}){return r<=1?null:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-6",children:[(0,t.jsx)("button",{onClick:()=>s(e-1),disabled:1===e,className:"px-3 py-1.5 text-sm rounded border border-border/60 disabled:opacity-40 disabled:cursor-not-allowed hover:border-vermilion/40 hover:text-vermilion transition-all",children:"‰∏ä‰∏ÄÈ°µ"}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(()=>{let t=[];if(r<=5)for(let e=1;e<=r;e++)t.push(e);else if(e<=3){for(let e=1;e<=4;e++)t.push(e);t.push("..."),t.push(r)}else if(e>=r-2){t.push(1),t.push("...");for(let e=r-3;e<=r;e++)t.push(e)}else{t.push(1),t.push("...");for(let r=e-1;r<=e+1;r++)t.push(r);t.push("..."),t.push(r)}return t})().map((r,a)=>"number"==typeof r?(0,t.jsx)("button",{onClick:()=>s(r),className:`w-8 h-8 text-sm rounded transition-all
                ${e===r?"bg-ink text-white":"hover:bg-paper/60 text-secondary"}`,children:r},a):(0,t.jsx)("span",{className:"px-1 text-secondary",children:r},a))}),(0,t.jsx)("button",{onClick:()=>s(e+1),disabled:e===r,className:"px-3 py-1.5 text-sm rounded border border-border/60 disabled:opacity-40 disabled:cursor-not-allowed hover:border-vermilion/40 hover:text-vermilion transition-all",children:"‰∏ã‰∏ÄÈ°µ"})]})}function d({title:e,books:s,showPagination:a=!1}){let[o,i]=(0,r.useState)(1),n=a?Math.ceil(s.length/9):1,d=a?s.slice((o-1)*9,9*o):s;return 0===s.length?null:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 px-2",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-ink",children:e}),(0,t.jsxs)("span",{className:"text-sm text-secondary",children:["(",s.length,")"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(e=>(0,t.jsx)(l,{book:e},e.id))}),a&&(0,t.jsx)(c,{currentPage:o,totalPages:n,onPageChange:i})]})}function u(){let{source:e}=(0,i.useSource)(),[o,c]=(0,r.useState)([]),[u,h]=(0,r.useState)("all"),[x,p]=(0,r.useState)(!0),[m,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{p(!0),b(null);let t=await (0,a.fetchAllBooks)(e);c(t)}catch(e){b(e instanceof Error?e.message:"Âä†ËΩΩÂ§±Ë¥•")}finally{p(!1)}})()},[e]);let{works:f,books:g,collections:y}=(0,r.useMemo)(()=>({works:o.filter(e=>e.type===s.BookResourceType.WORK),books:o.filter(e=>e.type===s.BookResourceType.BOOK),collections:o.filter(e=>e.type===s.BookResourceType.COLLECTION)}),[o]),j=(0,r.useMemo)(()=>"all"===u?o:o.filter(e=>e.type===u),[u,o]);return(0,t.jsxs)("div",{className:"px-6 py-8 md:px-12 lg:px-16 space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-border/40 shadow-sm space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"ÊêúÁ¥¢ÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠„ÄÇ„ÄÇ„ÄÇ",disabled:!0,className:"w-full pl-10 pr-4 py-3 bg-paper/30 border border-border/40 rounded-xl text-secondary/60 cursor-not-allowed"}),(0,t.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-secondary/30",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-secondary mr-2",children:"Á±ªÂûãÁ≠õÈÄâ:"}),n.map(e=>(0,t.jsx)("button",{onClick:()=>h(e.id),className:`
                  px-4 py-1.5 text-xs rounded-full border transition-all
                  ${u===e.id?"bg-ink text-white border-ink":"bg-transparent text-secondary border-border/60 hover:border-vermilion/40 hover:text-vermilion"}
                `,children:e.label},e.id))]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("p",{className:"text-secondary text-sm",children:["ÊâæÂà∞ ",(0,t.jsx)("span",{className:"text-ink font-semibold",children:j.length})," ÈÉ®Áõ∏ÂÖ≥Âè§Á±ç","github"===e?" (GitHub Ê∫ê)":" (Gitee Ê∫ê)"]}),m&&(0,t.jsx)("button",{onClick:()=>{p(!0),b(null),(0,a.fetchAllBooks)(e).then(e=>{c(e)}).catch(e=>b(e instanceof Error?e.message:"Âä†ËΩΩÂ§±Ë¥•")).finally(()=>p(!1))},className:"text-vermilion text-xs hover:underline",children:"ÈáçËØï"})]})]})]}),x?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,r)=>(0,t.jsx)("div",{className:"bg-paper/30 h-48 rounded-2xl animate-pulse"},r))}):"all"===u?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)(d,{title:"‰ΩúÂìÅ",books:f}),(0,t.jsx)(d,{title:"‰π¶",books:g,showPagination:!0}),(0,t.jsx)(d,{title:"‰∏õÁºñ",books:y})]}):j.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(e=>(0,t.jsx)(l,{book:e},e.id))}):(0,t.jsxs)("div",{className:"py-20 text-center bg-paper/20 rounded-3xl border border-dashed border-border/40",children:[(0,t.jsx)("p",{className:"text-secondary",children:"Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÂè§Á±ç"}),(0,t.jsx)("button",{onClick:()=>h("all"),className:"mt-4 text-vermilion text-sm hover:underline",children:"Ê∏ÖÈô§ÊâÄÊúâËøáÊª§Êù°‰ª∂"})]})]})}e.s(["default",()=>u],40867)}]);