(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},85130,89271,e=>{"use strict";var t,o=((t={}).WORK="work",t.COLLECTION="collection",t.BOOK="book",t);e.s(["BookResourceType",()=>o],89271);var a=e.i(85149);let r={};async function i(e,t){try{let a=await fetch(e,{cache:"no-store",signal:AbortSignal.timeout(5e3)});if(!a.ok)throw Error(`Failed to fetch from ${e}: ${a.statusText}`);let r=await a.json(),i=[],n=(e,o)=>{e&&Object.values(e).forEach(e=>{let a=(e.path||"").split("/");a.pop();let r=a.join("/"),n=r?`${r}/${e.id}`:e.id;i.push({id:e.id,name:e.title||e.name,type:o,isDraft:t,rawPath:e.path,localPath:e.path,assetPath:n,author:e.author,collection:e.collection,year:e.year,holder:e.holder})})};return n(r.books,o.BOOK),n(r.collections,o.COLLECTION),n(r.works,o.WORK),i}catch(e){throw e}}async function n(e="github"){if(r[e])return r[e];let t=[];if(a.isLocalMode)try{let t=await i("/local-data/index.json",!0);if(t.length>0)return console.log("Using local index data from book-index-draft"),r[e]=t,t}catch(e){console.warn("Local index not found, falling back to remote strategies")}let o=async t=>{if("github"===e)return i(t?a.GITHUB_BOOK_INDEX_DRAFT:a.GITHUB_BOOK_INDEX,t);let o=t?"book-index-draft":"book-index",r="main",n=`${a.JSDELIVR_FASTLY}/${a.GITHUB_ORG}/${o}@${r}/index.json`,l=`${a.JSDELIVR_CDN}/${a.GITHUB_ORG}/${o}@${r}/index.json`;try{return await i(n,t)}catch(e){return console.warn("Fastly index fetch failed, trying fallback:",e),await i(l,t)}};try{let e=await o(!0);t.push(...e)}catch(t){console.warn(`Failed to fetch draft index from ${e}:`,t)}try{let e=await o(!1);t.push(...e)}catch(t){console.warn(`Failed to fetch official index from ${e}:`,t)}let l=new Map;t.forEach(e=>{l.set(e.id,e)});let c=Array.from(l.values());return r[e]=c,c}async function l(e,t="github"){return(await n(t)).find(t=>t.id===e)||null}async function c(e,t="github"){if(a.isLocalMode&&e.localPath)try{let t=`/local-data/${e.localPath}`,o=await fetch(t,{cache:"no-store"});if(o.ok){console.log(`Using local book detail for ${e.id} from ${t}`);let a=await o.json();return await s(e,a)}}catch(e){console.warn("Local detail fetch failed, falling back to remote:",e)}if("github"===t){let o=`${a.GITHUB_BASE}/${a.GITHUB_ORG}/${e.isDraft?"book-index-draft":"book-index"}/main/${encodeURI(e.rawPath)}`,r=await fetch(o,{cache:"no-store"});if(!r.ok)throw Error(`Failed to fetch book detail from ${t}: ${r.statusText}`);let i=await r.json();return await s(e,i)}let o=e.isDraft?"book-index-draft":"book-index",r="main",i=`${a.JSDELIVR_FASTLY}/${a.GITHUB_ORG}/${o}@${r}/${encodeURI(e.rawPath)}`,n=`${a.JSDELIVR_CDN}/${a.GITHUB_ORG}/${o}@${r}/${encodeURI(e.rawPath)}`;try{let t=await fetch(i,{cache:"no-store",signal:AbortSignal.timeout(8e3)});if(!t.ok)throw Error(`Fastly status: ${t.status}`);let o=await t.json();return await s(e,o)}catch(a){console.warn("Fastly fetch failed, trying fallback CDN:",a);let t=await fetch(n,{cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error(`Failed to fetch book detail from CDN: ${t.statusText}`);let o=await t.json();return await s(e,o)}}async function s(e,t){let o=e.id;if(a.isLocalMode)try{let a=e.assetPath?`/local-data/${e.assetPath}`:`/books/${o}`,r=`${a}/images/image_manifest.json`;(await fetch(r,{method:"HEAD"})).ok&&(t.digital_assets={image_manifest_url:r,tex_files:["ce01.tex"]})}catch(e){}return t}function d(e){switch(e){case o.WORK:return"作品";case o.COLLECTION:return"丛编";case o.BOOK:return"书";default:return""}}function u(e){return e?"草稿":"正式"}e.s(["fetchAllBooks",()=>n,"fetchBookDetail",()=>c,"findBookById",()=>l,"getStatusLabel",()=>u,"getTypeLabel",()=>d],85130)},81827,e=>{"use strict";var t=e.i(18050),o=e.i(71645),a=e.i(22016),r=e.i(85130),i=e.i(67920),n=e.i(89271);function l({id:e,children:l,className:c,...s}){let{source:d}=(0,i.useSource)(),[u,f]=(0,o.useState)(null),[h,k]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let t=!0;return(async()=>{try{let o=await (0,r.findBookById)(e,d);t&&o&&(f(o.type),k(o.name))}catch(t){console.error(`Failed to fetch book info for ID: ${e}`,t)}})(),()=>{t=!1}},[e,d]),(0,t.jsxs)(a.default,{href:`/book-index/${e}`,className:`inline-flex items-center text-vermilion hover:underline font-medium decoration-dotted underline-offset-4 ${c||""}`,...s,children:[(()=>{let e="w-3.5 h-3.5 inline-block mr-1 opacity-70 align-middle";switch(u){case n.BookResourceType.BOOK:return(0,t.jsx)("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})});case n.BookResourceType.COLLECTION:return(0,t.jsx)("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})});case n.BookResourceType.WORK:return(0,t.jsx)("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});default:return null}})(),(0,t.jsx)("span",{children:h||l||e})]})}e.s(["default",()=>l])}]);